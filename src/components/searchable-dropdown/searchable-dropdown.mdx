import { Meta, Story, Canvas, Controls, Source } from '@storybook/blocks'
import { SearchableDropdown, ControlledSearchableDropdown, SearchableDropdownSearchLabel } from './index'
import { Label } from '../label'
import { RenderHtmlMarkup } from '../../storybook/render-html-markup'
import * as SearchableDropdownStories from './searchable-dropdown.stories'

<Meta of={SearchableDropdownStories} />

# Searchable Dropdown

A searchable dropdown list.

<Controls />

## Basic Usage

<Canvas of={SearchableDropdownStories.BasicUsage} />

`getResults` is used to get the results, and must return a promise that resolves to an array of results.

`getResultLabel` is used to get the label of a result, so must return a string.

`getResultValue` is used to get the value of a result, and must return a string.

`onChange` is called when the value changes.

`icon` is used to render an icon on the left of the input, and accepts any value that can be passed to `<Icon />`.

## Use with a label

<Canvas of={SearchableDropdownStories.UseWithALabel} />

## Use with a different icon

<Canvas of={SearchableDropdownStories.UseWithAnIcon} />

### Use with Types

You can add types to the dropdown by passing a type argument:

<Source code={`
type ObjectType = {
  id: string
  name: string
}
;<SearchableDropdown<ObjectType>
  getResults={async () => {
    return new Promise((resolve) => {
      setTimeout(() => {
        resolve([
          {
            id: '1',
            name: 'First',
          },
          {
            id: '2',
            name: 'Second',
          },
          {
            id: '3',
            name: 'Third',
          },
        ])
      }, 1000)
    })
  }}
  getResultLabel={(result) => result.name}
  getResultValue={(result) => result.id}
  onChange={(e) => console.log(e.target.value)}
/>
`} language="typescript" />

### Controlled Usage

<Canvas of={SearchableDropdownStories.ControlledUsage} />

### Default Value

<Canvas of={SearchableDropdownStories.DefaultValue} />

<RenderHtmlMarkup of={SearchableDropdownStories.DefaultValue} />
